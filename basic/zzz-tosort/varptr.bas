0 ' VARPTR.BAS
1 ' For this to work, ALL vars
2 ' MUST be declared here!
5 DIM A,AL(9)
6 DIM I,L,Z
10 A=1
20 L=VARPTR(A):GOSUB 1000
30 'DIM A(9)
40 FOR I=0 TO 9:A(I)=I+1:NEXT
50 L=VARPTR(A(0)):GOSUB 1100
999 GOTO 999
1000 ' VARIABLE
1005 PRINT "VARPTR: ",L
1010 FOR Z=L TO L+4:PRINT Z,PEEK(Z):NEXT:RETURN

1100 ' ARRAY
1101 ' 0-1 = Name
1102 ' 2-3 = Length (array + header)
1103 ' 4   = # Dimensions
1104 PRINT "ARRAY:"
1105 GOSUB 1000
1110 PRINT "NAME  : ";CHR$(PEEK(L));CHR$(PEEK(L+1))
1115 PRINT "LENGTH:";PEEK(L+2)*256+PEEK(L+3)
1130 PRINT "# DIMS:";PEEK(L+4);
1140 FOR Z=0 TO PEEK(L+4)*2 STEP 2
1150 PRINT ,PEEK(L+5*Z)*256+PEEK(L+5*Z+1)
1160 NEXT
1170 RETURN
