1 POKE 65395,0
5 PI=3.141592653589793238
10 'MODE1
11 PMODE 4,1:PCLS:SCREEN 1,1:PMODE 3,1
20 'VDU5
30 'FORG=RND(-64)TO400
31 Z=RND(-42):FORG=-42TO400
40 't=RND(99):q=RND(99)
41 TL=RND(99):QL=RND(99)
50 'u=RND(1280):v=RND(1024)
51 UL=RND(1280):VL=RND(1024)
60 'A=RND(1)*3
61 A=RND(0)*3
70 R=90/(1+RND(200))
80 'Q=1+R*(.5+RND(1)/2)
81 Q=1+R*(.5+RND(0)/2)
90 'a=1+3*RND(1)^2
91 AL=1+3*RND(0)^2
100 M=1
110 'IFRND(9)<4Q=R:t=0:q=0:A=0:M=PI/3:a=1
110 IFRND(9)<4THENQ=R:TL=0:QL=0:A=0:M=PI/3:AL=1
120 'C=(1+3*RND(1)^2)*R*R
121 C=(1+3*RND(0)^2)*R*R
130 'FORi=0TOC
131 FORIL=0TOC
140 'S=-LNRND(1)
141 'S=-(LOG(RND(0)) / 0.4342944819)
142 S=-(LOG(RND(0))*2.302585093)
150 'T=i*M
151 T=IL*M
160 'U=S*R*SINT
161 U=S*R*SIN(T)
170 'V=S*Q*COST
171 V=S*Q*COS(T)
180 T=S*A
190 'X=U*COST+V*SINT
191 X=U*COS(T)+V*SIN(T)
200 'Y=V*COST-U*SINT
201 Y=V*COS(T)-U*SIN(T)
210 D=(X*X+Y*Y)/(R*R+Q*Q)
220 Z=99*((2.7^-D)+.1)
230 'Z=Z*(RND(1)-.5)^3
231 Z=Z*(RND(0)-.5)^3
240 'y=Y*COSt+Z*SINt
241 YL=Y*COS(TL)+Z*SIN(TL)
250 'Z=Z*COSt-Y*SINt
251 Z=Z*COS(TL)-Y*SIN(TL)
260 'x=u+X*COSq+y*SINq
261 XL=UL+X*COS(QL)+YL*SIN(QL)
270 'y=v-X*SINq+y*COSq
271 YL=VL-X*SIN(QL)+YL*COS(QL)
275 IF XL<0 OR XL>255 THEN 321
276 IF YL<0 OR YL>191 THEN 321
280 'P=POINT(x,y)+a
281 P=PPOINT(XL,YL)+AL
290 'IFP>3P=3
291 IFP>4THENP=4
300 'GCOL0,P
300 COLORP
310 'PLOT69,x,y
311 PSET(XL,YL)
320 'NEXT,
321 NEXT:NEXT
330 REM
340 GOTO340
