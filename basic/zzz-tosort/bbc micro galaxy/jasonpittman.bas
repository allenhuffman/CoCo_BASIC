10 RGB
20 PALETTE0,0:PALETTE1,36:PALETTE2,54:PALETTE3,63
30 HSCREEN1:HCLS0
40 PI=3.141592653589793238
50 G=RND(-64)
60 FORG=GTO400
70 LT=RND(99):LQ=RND(99)
80 LU=RND(320):LV=RND(192)
90 A=RND(0)*3
100 R=90/(1+RND(200))
110 Q=1+R(.5+RND(0)/2)
120 LA=1+3*RND(0)^2
130 M=1
140 IFRND(9)<4THENQ=R:LT=0:LQ=0:A=0:M=PI/3:LA=1
150 C=(1+3*RND(0)^2)*R*R
160 FORLI=0TOC
170 S=-(LOG(RND(0)))
180 T=LI*M
190 U=S*R*SIN(T)
200 V=S*Q*COS(T)
210 T=S*A
220 X=U*COS(T)+V*SIN(T)
230 Y=V*COS(T)-U*SIN(T)
240 D=(X*X+Y*Y)/(R*R+Q*Q)
250 Z=99*((2.7^-D)+.1)
260 Z=Z*(RND(0)-.5)^3
270 LY=Y*COS(LT)+Z*SIN(LT)
280 Z=Z*COS(LT)-Y*SIN(LT)
290 LX=LU+X*COS(LQ)+LY*SIN(LQ)
300 LY=LV-X*SIN(LQ)+LY*COS(LQ)
310 IF LX<0ORLX>320ORLY<0ORLY>192THEN 370
330 P=HPOINT(LX,LY)+LA
340 IFP>3THENP=3
350 HCOLORP
360 HSET(LX,LY)
370 NEXT:NEXT
380 GOTO 380
