10 POKE65497,0:HSCREEN4:PALETTE 0,0:PALETTE1,32:PALETTE2,55:PALETTE3,63:HCLS0
20 REM
30 FOR G=-64 TO 400
40 T1=RND(99):Q1=RND(99)
50 U1=RND(1280):V1=RND(1024)
60 A=RND(0)*3
70 R=90/(1+RND(200))
80 Q=1+R*(.5+RND(0)/2)
90 A1=1+3*RND(0)^2
100 M=1
110 IF RND(9)<4 THEN Q=R:T1=0:Q1=0:A=0:M=3.141592/3:A1=1
120 C=(1+3*RND(0)^2)*R*R
130 FOR I1=0 TO C
140 S=-LOG(RND(0))
150 T=I1*M
160 U=S*R*SIN(T)
170 V=S*Q*COS(T)
180 T=S*A
190 X=U*COS(T)-V*SIN(T)
200 Y=V*COS(T)-U*SIN(T)
210 D=(X*X+Y*Y)/(R*R+Q*Q)
220 Z=99*((2.7^-D)+.1)
230 Z=Z*(RND(0)-.5)^3
240 Y1=Y*COS(T1)+Z*SIN(T1)
250 Z=Z*COS(T1)-Y*SIN(T1)
260 X1=ABS(U1+X*COS(Q1)+Y*SIN(Q1)):X1=X1/2
270 Y1=ABS(V1-X*SIN(Q1)+Y1*COS(Q1)):Y1=Y1/5.3333334
280 P=HPOINT(X1,Y1)+A1
290 IF P>3 THEN P=3
300 HCOLOR P,0
310 HSET(X1,Y1)
320 NEXT I1,G
330 SOUND 10,10
340 GOTO 340
