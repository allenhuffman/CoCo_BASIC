0 REM VMC-10 WITH MCX-128 ROM THEN LOAD PICTURE TO ADDRESS 1226 AND IS BETTER IF LIMITED TO MC-10 9 COLORS NO NEED TO FLIP PICTURE
1 H=62:V=0
5CLS:?"PLEASE LOAD A 64X32 256 COLOR BMP"
6?"PALETTE MUST ONLY HAVE NINE COLORS"
9 A$=INKEY$:IFA$=""THEN9
10 INPUT"BLACK IS 0-8";JP
14 CLS0
15 FOR W = 0 TO 8:W1=W
16 FOR A = 4349 TO 2302 STEP -2
30 C1=PEEK(A):C2=PEEK(A-1):C3=PEEK(A-64):C4=PEEK(A-65)
31 IF W=0 THEN GOSUB 1000
32 IF C1<>W AND C2<>W AND C3<>W AND C4<>W THEN 47
35 P1=POINT(H+1,V):P2=POINT(H,V):P3=POINT(H+1,V+1):P4=POINT(H,V+1)
36 IF P1>0 THEN P5=P5+1
37 IF P2>0 THEN P5=P5+1
38 IF P3>0 THEN P5=P5+1
39 IF P4>0 THEN P5=P5+1
REM IF C IS GREATER ALL 4 POINTS SHOULD BE RESET OTHERWIZE BLEED OCCURS
40 IF C1>0 THEN C5=C5+1
41 IF C2>0 THEN C5=C5+1
42 IF C3>0 THEN C5=C5+1
43 IF C4>0 THEN C5=C5+1
44 IF P5>0 THEN P5=0:C5=0:GOTO 69
45 P5=0:C5=0
46 IF JP=W THEN GOSUB1000 :GOTO 69 :REM COLOR REDO
47 IFW=0 THEN TC=5:GOTO64 ELSE TC=W
48 IFW=1 THEN TC=0:GOTO64 ELSE TC=W
49 IFW=2 THEN TC=3:GOTO64 ELSE TC=W
50 IFW=3 THEN TC=1:GOTO64 ELSE TC=W
51 IFW=4 THEN TC=5:GOTO64 ELSE TC=W
52 IFW=5 THEN TC=4:GOTO64 ELSE TC=W
53 IFW=6 THEN TC=6:GOTO64 ELSE TC=W
54 IFW=7 THEN TC=7:GOTO64 ELSE TC=W
55 IFW=8 THEN TC=8:GOTO64 ELSE TC=W
64 IFC1=W THEN SET(H+1,V,TC)
65 IFC2=W THEN SET(H,V,TC)
66 IFC3=W THEN SET(H+1,V+1,TC)
67 IFC4=W THEN SET(H,V+1,TC)
69 H=H-2:IFH<0THENH=62:A=A-64:V=V+2:IFV>30THENV=0
70 NEXTA
75 NEXTW
500 GOTO 500
1000 IFC1=W THEN RESET(H+1,V)
1010 IFC2=W THEN RESET(H,V)
1020 IFC3=W THEN RESET(H+1,V+1)
1030 IFC4=W THEN RESET(H,V+1)
1040 RETURN
1050 REM USE Image Analyzer 1.40 TO REDUCE LORHE PALLET DOWN TO 9 COLORS
1060 REM BY FIRST SAVING THE IMAGE AS A 16 COLOR IMAGE
1070 REM THEN IN THE IMAGE ANALYZER PROGRAM OPTIMIZE THE PALLET FIRST
1080 REM ALSO CREATE A MC-10 COLOR PALLET AND LOAD THAT AFTER REDUCING COLORS TO 9
1090 REM LINE 10 LET YOU PICK BLACK AND 47 - 53 ALLOWS YOU TO SWAP COLORS BY
1100 REM CHANGING TEMP COLOR TC TO AND OTHER MC-10 COLOR
1110 REM SWAPING COLORS ALLOWS YOU TO FIX THE INCORRECT PALLET
1120 REM THIS USES VMC-10 WITH THE MCX-128 ROM
