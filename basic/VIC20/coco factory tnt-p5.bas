5 REM***************                 * FACTORY TNT *                 ******BY:******
6 REM*ALLEN HUFFMAN*                 ***************
7 DIM F(1),FA(1),FB(1),FC(1),FD(1),FE(1),FF(1),FG(1),FH(1),FI(1),FJ(1)
8 DIM F0(1),F1(1),F2(1),F3(1),F4(1),F5(1),F6(1),F7(1),F8(1),F9(1)
9 DIM Z,L,V:GOSUB 5000
10 PMODE 4,1:PCLS1:SCREEN 1,1:ML=3:SC=0
15 GOSUB 1000
35 LX=SX+(10*8):LY=SY+(17*8)
40 BX=SX+(2+RND(18))*8:BY=SY+(3*8)
42 REM PRINT"{home}{space*2}{reverse on}men:{reverse off}";ML;" {reverse on}score:{reverse off}";SC
45 PUT(LX,LY)-(LX+7,LY+7),FF:PUT(BX,BY)-(BX+7,BY+7),FE
50 A=A+1:IFA=>3THENLINE(BX,BY)-(BX+7,BY+7),PSET,BF:BY=BY+8:PUT(BX,BY)-(BX+7,BY+7),FE:A=1
55 IFBY=>144THEN150store
95 POKE&H153,&HFF:POKE&H155,&HFF
100 A$=INKEY$:IFA$=""THEN45
105 LINE(LX,LY)-(LX+7,LY+7),PSET,BF
110 IFA$="A"THENLX=LX-8
115 IFA$="S"THENLX=LX+8
120 IFLX<40ORLX>200THEN130
125 GOTO45
130 IFA$="A"THENLX=LX+8
135 IFA$="S"THENLX=LX-8
140 GOTO45
150 IFBX=LX THEN200
155 PUT(BX,BY)-(BX+7,BY+7),FJ
160 REM
165 FORQ=1TO18:SOUNDQ,A:NEXTQ
170 LINE(BX,BY)-(BX+7,BY+7),PSET,BF
175 ML=ML-1
180 IFML=0THEN250
190 GOTO40
200 SC=SC+10:SOUND117,1:SOUND185,1
205 GOTO40
250 CLS
255 PRINT"**********************":PRINT"*******GAME OVER******":PRINT"**********************":PRINT
260 IF SC>TP THEN TP=SC:GOTO300
265 PRINT"FINAL SCORE:";SC
270 PRINT:PRINT"TOP SCORE  :";TP
275 PRINT:PRINT"====PLAYER RATING===="
285 IFSC=<50THENR$="DISHWASHER"
286 IFSC<100ANDSC>50THENR$="PRIVATE"
287 IFSC=>100ANDSC<200THENR$="GETTING BETTER"
288 IF SC=>200ANDSC<300THENR$="WELL DONE!"
289 IFSC=>300THENR$="SUPER FANTASTIC, EXTRA"+CHR$(13)+"GREAT, TOP DOG, #1"
290 PRINT:PRINT"RANK:":PRINT:PRINTR$
295 PRINT:PRINT"WILL YOU PLAY AGAIN?";
296 Q$=INKEY$:IFQ$=""THEN296
297 IFQ$="N"THEN350
298 IFQ$="Y"THEN10
299 GOTO296
300 PRINT"**********************":PRINT"******TOP SCORE*******":PRINT"**********************":PRINT
302 RESTORE
305 READA:IFA=-1THEN250
306 IFA=0THENFORA=1TO90:NEXT:GOTO305
310 SOUNDA,2
325 GOTO305
350 DATA89,108,125,0,89,108,125,0,89,108,125,0,133,147,0,0,89,108,125,0,89,108,125
355 DATA0,89,108,125,0,147,108,-1
400 END

1000 ' DRAW SCREEN
1010 SX=4*8:SY=1*8
1020 ' SIDES
1030 FOR Y=1 TO 19
1040 PUT (SX,SY+Y*8)-(SX+7,SY+Y*8+7),F
1050 PUT (SX+22*8,SY+Y*8)-(SX+22*8+7,SY+Y*8+7),F
1060 NEXT
1070 ' PIPES LEFT
1080 PUT (SX+1*8,SY+1*8)-(SX+1*8+7,SY+1*8+7),FA
1090 ' CONVEYOR LEFT
1100 PUT (SX+1*8,SY+18*8)-(SX+1*8+7,SY+18*8+7),FG
1110 ' BOTTOM LEFT
1120 PUT (SX+1*8,SY+19*8)-(SX+1*8+7,SY+19*8+7),F
1130 PUT (SX+1*8,SY+21*8)-(SX+1*8+7,SY+21*8+7),F
1140 PUT (SX+2*8,SY+20*8)-(SX+2*8+7,SY+20*8+7),F
1150 ' PIPE/CONVEYOR/BOTTOM
1160 FOR X=2 TO 20
1170 PUT (SX+X*8,SY+1*8)-(SX+X*8+7,SY+1*8+7),FB
1180 PUT (SX+X*8,SY+2*8)-(SX+X*8+7,SY+2*8+7),FD
1190 PUT (SX+X*8,SY+18*8)-(SX+X*8+7,SY+18*8+7),FH
1200 PUT (SX+X*8,SY+19*8)-(SX+X*8+7,SY+19*8+7),F
1210 PUT (SX+X*8,SY+21*8)-(SX+X*8+7,SY+21*8+7),F
1220 NEXT
1230 PUT (SX+20*8,SY+20*8)-(SX+20*8+7,SY+20*8+7),F
1240 ' PIPES RIGHT
1250 PUT (SX+21*8,SY+1*8)-(SX+21*8+7,SY+1*8+7),FC
1260 ' CONVEYOR RIGHT
1270 PUT (SX+21*8,SY+18*8)-(SX+21*8+7,SY+18*8+7),FI
1280 ' BOTTOM RIGHT
1290 PUT (SX+21*8,SY+19*8)-(SX+21*8+7,SY+19*8+7),F
1300 PUT (SX+21*8,SY+21*8)-(SX+21*8+7,SY+21*8+7),F
1310 RETURN

5000 ' LOAD DATA IN TO ARRAYS
5010 PRINT "LOADING DATA..."
5015 ' SKIP OVER MUSIC DATA
5016 RESTORE
5017 READ V:IF V<>-1 THEN 5017
5018 '
5020 L=VARPTR(F(0)):GOSUB 5240
5030 L=VARPTR(FA(0)):GOSUB 5240
5040 L=VARPTR(FB(0)):GOSUB 5240
5050 L=VARPTR(FC(0)):GOSUB 5240
5060 L=VARPTR(FD(0)):GOSUB 5240
5070 L=VARPTR(FE(0)):GOSUB 5240
5080 L=VARPTR(FF(0)):GOSUB 5240
5090 L=VARPTR(FG(0)):GOSUB 5240
5100 L=VARPTR(FH(0)):GOSUB 5240
5110 L=VARPTR(FI(0)):GOSUB 5240
5120 L=VARPTR(FJ(0)):GOSUB 5240
5130 L=VARPTR(F0(0)):GOSUB 5240
5140 L=VARPTR(F1(0)):GOSUB 5240
5150 L=VARPTR(F2(0)):GOSUB 5240
5160 L=VARPTR(F3(0)):GOSUB 5240
5170 L=VARPTR(F4(0)):GOSUB 5240
5180 L=VARPTR(F5(0)):GOSUB 5240
5190 L=VARPTR(F6(0)):GOSUB 5240
5200 L=VARPTR(F7(0)):GOSUB 5240
5210 L=VARPTR(F8(0)):GOSUB 5240
5220 L=VARPTR(F9(0)):GOSUB 5240
5230 RETURN
5240 ' READ DATA AND POKE AT L
5250 FOR Z=L TO L+7:READ V:POKE Z,(NOT V)+256:NEXT:RETURN
5260 ' @ - BLOCK
5270 DATA 255,255,255,255,255,255,255,255
5280 ' A - PIPE LEFT
5290 DATA 7,8,200,112,64,112,200,7
5300 ' B - PIPE MIDDLE
5310 DATA 255,0,24,60,60,24,0,255
5320 ' C - PIPE RIGHT
5330 DATA 224,16,19,14,2,14,19,224
5340 ' D - SPOUT
5350 DATA 24,24,36,36,66,126,0,0
5360 ' E - BOMB
5370 DATA 24,24,60,118,122,126,126,60
5380 ' F - BOWL
5390 DATA 0,0,255,255,129,129,66,60
5400 ' G - CONVEYOR LEFT
5410 DATA 63,64,152,188,188,152,64,63
5420 ' H - CONVEYOR MIDDLE
5430 DATA 255,0,24,60,60,24,0,255
5440 ' I - CONVEYOR RIGHT
5450 DATA 252,2,25,61,61,25,2,252
5460 ' J - MUSHROOM CLOUD
5470 DATA 126,255,255,255,90,24,24,60
5480 ' 0
5490 DATA 62,34,34,34,34,34,62,0
5500 ' 1
5510 DATA 8,8,8,8,8,8,8,0
5520 ' 2
5530 DATA 62,2,2,62,32,32,62,0
5540 ' 3
5550 DATA 62,2,2,62,2,2,62,0
5560 ' 4
5570 DATA 34,34,34,62,2,2,2,0
5580 ' 5
5590 DATA 62,32,32,62,2,2,62,0
5600 ' 6
5610 DATA 62,32,32,62,34,34,62,0
5620 ' 7
5630 DATA 62,2,2,2,2,2,2,0
5640 ' 8
5650 DATA 62,34,34,62,34,34,62,0
5660 ' 9
5670 DATA 62,34,34,62,2,2,62,0
5680 ' 9
5690 DATA 62,34,34,62,2,2,62,0
5700 DATA -1
