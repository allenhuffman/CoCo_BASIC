10 '
20 ' PACPUT.BAS
30 ' ALLEN C. HUFFMAN
40 ' SUBETHASOFTWARE.COM
50 ' 2023-01-19
60 '
 
70 ' LOAD SPRITES
80 DIMU0(3),U1(3),U2(3)
90 DIMD0(3),D1(3),D2(3)
100 DIML0(3),L1(3),L2(3)
110 DIMR0(3),R1(3),R2(3)
120 DIMA0(3),A1(3),A2(3),A3(3),A4(3),A5(3),A6(3),A7(3)
130 DIMB0(3),B1(3),B2(3),B3(3),B4(3),B5(3),B6(3),B7(3)
140 DIMC0(3),C1(3),C2(3),C3(3),C4(3),C5(3),C6(3),C7(3)
150 DIMZ,L,V'VERY IMPORTANT!
160 GOSUB820
 
170 ' CRROW KEYS
180 KY$=CHR$(94)+CHR$(10)+CHR$(8)+CHR$(9)
190 M=1:SW=7:SH=15
200 ' 256X192 BLACK AND WHITE
210 PMODEM,1:PCLS1:SCREEN1,1
 
220 ' PAC POSITION, DIR, FRAME
230 PX=8:PY=8:PD=4:PF=0
240 ' OLD LOCATION
250 OX=8:OY=8
 
260 WD=128
270 FOR X=32 TO 32+WD-SW STEP 8

275 LINE(0,WD-X+SH)-(7,WD-X+15+SH),PRESET,BF
280 PUT(0,WD-X)-(7,WD-X+15),A0

275 LINE(WD,X-SH)-(WD+7,X+15-SH),PRESET,BF
290 PUT(WD,X)-(WD+7,X+15),A2

300 PUT(WD-X,WD+0)-(WD-X+SW,WD+15),A4

310 PUT(X,0)-(X+SW,15),A6
 
280 PUT(0,WD-X)-(7,WD-X+15),A1
290 PUT(WD,X)-(WD+7,X+15),A3
300 PUT(WD-X,WD+0)-(WD-X+SW,WD+15),A5
310 PUT(X,0)-(X+SW,15),A7
 
315 NEXT
320 GOTO 270
 
330 ' ERASE PREV POSITION
340 LINE(OX,OY)-(OX+SW,OX+SH),PRESET,BF
 
350 ' PUT PAC ON SCREEN
360 ONPDGOTO380,440,500,560
 
370 ' UP
380 ONPFGOTO390,400,410,420
390 PUT(PX,PY)-(PX+SW,PY+SH),U0:GOTO620
400 PUT(PX,PY)-(PX+SW,PY+SH),U1:GOTO620
410 PUT(PX,PY)-(PX+SW,PY+SH),U2:GOTO620
420 PUT(PX,PY)-(PX+SW,PY+SH),U1:GOTO620
 
430 ' DOWN
440 ONPFGOTO450,460,470,480
450 PUT(PX,PY)-(PX+SW,PY+SH),D0:GOTO620
460 PUT(PX,PY)-(PX+SW,PY+SH),D1:GOTO620
470 PUT(PX,PY)-(PX+SW,PY+SH),D2:GOTO620
480 PUT(PX,PY)-(PX+SW,PY+SH),D1:GOTO620
 
490 ' LEFT
500 ONPFGOTO510,520,530,540
510 PUT(PX,PY)-(PX+SW,PY+SH),L0:GOTO620
520 PUT(PX,PY)-(PX+SW,PY+SH),L1:GOTO620
530 PUT(PX,PY)-(PX+SW,PY+SH),L2:GOTO620
540 PUT(PX,PY)-(PX+SW,PY+SH),L1:GOTO620
 
550 ' RIGHT
560 ONPFGOTO570,580,590,600
570 PUT(PX,PY)-(PX+SW,PY+SH),R0:GOTO620
580 PUT(PX,PY)-(PX+SW,PY+SH),R1:GOTO620
590 PUT(PX,PY)-(PX+SW,PY+SH),R2:GOTO620
600 PUT(PX,PY)-(PX+SW,PY+SH),R1:GOTO620
 
610 ' READ KEYBOARD
620 POKE&H155,&HFF:POKE&H156,&HFF:POKE&H157,&HFF:POKE&H158,&HFF
630 PF=PF+1:IFPF>4THENPF=0
640 A$=INKEY$:IFA$=""THEN350'530
650 LN=INSTR(KY$,A$):IFLN=0THEN620
660 OX=PX:OY=PY
 
670 ONLNGOTO690,720,750,780
 
680 ' UP
690 IFPD=1THENIFPY>0THENPY=PY-8:GOTO340
700 PD=1:GOTO360
 
710 ' DOWN
720 IFPD=2THENIFPY<184THENPY=PY+8:GOTO340
730 PD=2:GOTO360
 
740 ' LEFT
750 IFPD=3THENIFPX>0THENPX=PX-8:GOTO340
760 PD=3:GOTO360
 
770 ' RIGHT
780 IFPD=4THENIFPX<248THENPX=PX+8:GOTO340
790 PD=4:GOTO360
 
800 GOTO800
 
810 ' LOAD SPRITE CHARACTERS
820 PRINT"LOADING DATA";
 
830 ' PAC UP
840 L=VARPTR(U0(0)):GOSUB1120
850 L=VARPTR(U1(0)):GOSUB1120
860 L=VARPTR(U2(0)):GOSUB1120
 
870 ' PAC DOWN
880 L=VARPTR(D0(0)):GOSUB1120
890 L=VARPTR(D1(0)):GOSUB1120
900 L=VARPTR(D2(0)):GOSUB1120
 
910 ' PAC LEFT
920 L=VARPTR(L0(0)):GOSUB1120
930 L=VARPTR(L1(0)):GOSUB1120
940 L=VARPTR(L2(0)):GOSUB1120
 
950 ' PAC RIGHT
960 L=VARPTR(R0(0)):GOSUB1120
970 L=VARPTR(R1(0)):GOSUB1120
980 L=VARPTR(R2(0)):GOSUB1120
 
990 ' GHOST A UP
1000 L=VARPTR(A0(0)):GOSUB1120
1010 L=VARPTR(A1(0)):GOSUB1120
 
1020 ' GHOST A DOWN
1030 L=VARPTR(A2(0)):GOSUB1120
1040 L=VARPTR(A3(0)):GOSUB1120
 
1050 ' GHOST A LEFT
1060 L=VARPTR(A4(0)):GOSUB1120
1070 L=VARPTR(A5(0)):GOSUB1120
 
1080 ' GHOST A RIGHT
1090 L=VARPTR(A6(0)):GOSUB1120
1100 L=VARPTR(A7(0)):GOSUB1120
 
1110 RETURN
 
1120 ' READ DATA AND POKE AT L
1130 PRINT".";
1140 FORZ=LTOL+7:READV:POKEZ,V:NEXT:RETURN
 
1150 ' UP PAC OPEN/MID/CLOSE
1160 DATA192,195,243,243,255,255,255,60
1170 DATA48,243,243,243,255,255,255,60
1180 DATA60,255,255,255,255,255,255,60
 
1190 ' DOWN PAC OPEN/MID/CLOSE
1200 DATA60,255,255,255,207,207,195,3
1210 DATA60,255,255,255,207,207,207,12
1220 DATA60,255,255,255,255,255,255,60
 
1230 ' LEFT PAC OPEN/MID/CLOSE
1240 DATA60,255,63,15,15,63,255,60
1250 DATA60,255,255,63,15,255,255,60
1260 DATA60,255,255,255,255,255,255,60
 
1270 ' RIGHT PAC OPEN/MID/CLOSE
1280 DATA60,255,252,240,240,252,255,60
1290 DATA60,255,255,252,240,255,255,60
1300 DATA60,255,255,255,255,255,255,60
 
1310 ' GHOST A UP
1320 DATA60,243,207,255,255,255,255,204
1330 DATA60,243,207,255,255,255,255,51
 
1340 ' GHOST A DOWN
1350 DATA60,255,255,207,243,255,255,204
1360 DATA60,255,255,207,243,255,255,51
 
1370 ' GHOST A LEFT
1380 DATA60,255,255,51,255,255,255,204
1390 DATA60,255,255,51,255,255,255,51
 
1400 ' GHOST A RIGHT
1410 DATA60,255,255,204,255,255,255,204
1420 DATA60,255,255,204,255,255,255,51
 
 