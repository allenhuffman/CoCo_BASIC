0 ' 
1 ' TANKPUT.BAS
2 ' ALLEN C. HUFFMAN
3 ' SUBETHASOFTWARE.COM
4 ' 2023-01-16
5'

10 ' LOAD SPRITES
20 DIM TU(1),TD(1),TL(1),TR(1),TB(1),Z,L,V:GOSUB 2000

30 ' ARROW KEYS
40 KY$=CHR$(94)+CHR$(10)+CHR$(8)+CHR$(9)+" "

50 ' 256X192 BLACK AND WHITE
60 PMODE 4,1:PCLS 1:SCREEN 1,1

70 ' TANK POSITION AND DIR.
80 TX=0:TY=0:TD=4:OX=0:OY=0
81 BX=0:BY=0:MX=0:MY=0

90 ' ERASE PREV POSITION
100 LINE(OX,OY)-(OX+7,OY+7),PSET,BF

110 ' PUT TANK ON SCREEN
120 ON TD GOTO 130,140,150,160
130 PUT(TX,TY)-(TX+7,TY+7),TU:GOTO 171
140 PUT(TX,TY)-(TX+7,TY+7),TD:GOTO 171
150 PUT(TX,TY)-(TX+7,TY+7),TL:GOTO 171
160 PUT(TX,TY)-(TX+7,TY+7),TR

170 ' READ KEYBOARD (WASD)

171 IF MX=0 THEN 175
172 LINE(BX,BY)-(BX+7,BY+8),PSET,BF
173 BX=BX+MX:IF BX<0 OR BX>248 THEN MX=0:GOTO 175
174 PUT(BX,BY)-(BX+7,BY+7),TB

175 IF MY=0 THEN 180
176 LINE(BX,BY)-(BX+7,BY+8),PSET,BF
177 BY=BY+MY:IF BY<0 OR BY>184 THEN MY=0:GOTO 180
178 PUT(BX,BY)-(BX+7,BY+7),TB

180 POKE&H155,&HFF:POKE&H156,&HFF:POKE&H157,&HFF:POKE&H158,&HFF
190 A$=INKEY$:IF A$="" THEN 171
200 LN=INSTR(KY$,A$):IF LN=0 THEN 171
210 OX=TX:OY=TY
220 ON LN GOTO 240,270,300,330,350

230 ' UP
240 TD=1:IF TY>0 THEN TY=TY-8:GOTO 100
250 GOTO 120
260 ' DOWN
270 TD=2:IF TY<184 THEN TY=TY+8:GOTO 100
280 GOTO 120
290 ' LEFT
300 TD=3:IF TX>0 THEN TX=TX-8:GOTO 100
310 GOTO 120
320 ' RIGHT
330 TD=4:IF TX<248 THEN TX=TX+8:GOTO 100
340 GOTO 120

350 IF MX=0 THEN IF MY=0 THEN 352
351 GOTO 171
352 BX=TX:BY=TY
355 IF TD=1 THEN MX=0:MY=-8:GOTO 177
360 IF TD=2 THEN MX=0:MY=8:GOTO 177
370 IF TD=3 THEN MX=-8:MY=0:GOTO 173
380 IF TD=4 THEN MX=8:MY=0:GOTO 173

999 GOTO 999

2000 ' LOAD SPRITE CHARACTERS
2010 PRINT "LOADING DATA";
2030 L=VARPTR(TU(0)):GOSUB 3000
2040 L=VARPTR(TD(0)):GOSUB 3000
2050 L=VARPTR(TL(0)):GOSUB 3000
2060 L=VARPTR(TR(0)):GOSUB 3000
2070 L=VARPTR(TB(0)):GOSUB 3000
2190 RETURN

3000 ' READ DATA AND POKE AT L
3010 PRINT ".";
3020 FOR Z=L TO L+7:READ V:POKE Z,(NOT V)+256:NEXT:RETURN
3030 ' 8X8 SPRITE CHARACTERS
3040 ' TANK UP
3050 DATA 24,24,219,255,255,255,255,195
3060 ' TANK DOWN
3070 DATA 195,255,255,255,255,219,24,24
3080 ' TANK LEFT
3090 DATA 63,63,30,254,254,30,63,63
3100 ' TANK RIGHT
3110 DATA 252,252,120,127,127,120,252,252
3120 ' BULLET
3130 DATA 0,0,0,24,24,0,0,0
