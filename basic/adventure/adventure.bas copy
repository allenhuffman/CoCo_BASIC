10 REM adventure.bas
20 ' CoCo 1/2 double speed. (65497,0 for CC3)
30 POKE 65495,0
40 ' 15 Atari colors to CoCo colors
50 DIM CC(14):FOR A=0 TO 14:READ CC(A):NEXT
60 ' 23 screens, 21 bytes each
70 DIM RG(22,20)
80 ' 30 rooms, 7 bytes each
90 DIM RM(29,6)
100 ' Bit values (powers of 2)
110 DIM BT(7):FOR A=0 TO 7:BT(A)=INT(2^A):NEXT
120 ' Main
130 PRINT"LOADING ROOM GRAPHICS."
140 FOR A=0 TO 22:FOR B=0 TO 20:READ RG(A,B):NEXT:NEXT
150 PRINT"LOADING ROOM LAYOUT."
160 FOR A=0 TO 29:FOR B=0 TO 6:READ RM(A,B):NEXT:NEXT
170 CLS:RM=0
180 PRINT@448,;:INPUT "ROOM";RM:GOSUB 220:GOTO 180
190 END
200 ' Draw room
210 ' GFX,RMFLG,CLR,UP,RIGHT,DOWN,LEFT
220 CLS:RG=RM(RM,0):RF=RM(RM,1):RC=RM(RM,2):RU=RM(RM,3):RR=RM(RM,4):RD=RM(RM,5):RL=RM(RM,6)
230 C=CC(RC)
240 PRINT "R";RM;RF;RC;"ULDR:";RU;RL;RD;RR
250 X=0:Y=2:FOR Z1=0 TO 20 STEP 3:FOR Z2=1 TO 3
260 ' Draw left half normal.
270 Z=RG(RG,Z1):GOSUB530
280 Z=RG(RG,Z1+1):GOSUB480
290 Z=RG(RG,Z1+2):GOSUB430
300 IF (RF AND 1) THEN 370
310 ' Draw right half reversed
320 Z=RG(RG,Z1+2):GOSUB480
330 Z=RG(RG,Z1+1):GOSUB430
340 Z=RG(RG,Z1):GOSUB580
350 GOTO 400
360 ' Draw right half mirrored
370 Z=RG(RG,Z1):GOSUB530
380 Z=RG(RG,Z1+1):GOSUB480
390 Z=RG(RG,Z1+2):GOSUB430
400 X=0:Y=Y+1:NEXT:NEXT
410 RETURN
420
430 ' Show 8 bits forward
440 FOR BT=0 TO 7:IF Z AND BT(BT) THEN IF C=0 THEN RESET(X,Y) ELSE SET(X,Y,C)
450 X=X+1
460 NEXT:RETURN
470
480 ' Show 8 bits reversed
490 FOR BT=7 TO 0 STEP -1:IF Z AND BT(BT) THEN IF C=0 THEN RESET(X,Y) ELSE SET(X,Y,C)
500 X=X+1
510 NEXT:RETURN
520 
530 ' Show 4 bits forward
540 FOR BT=4 TO 7:IF Z AND BT(BT) THEN IF C=0 THEN RESET(X,Y) ELSE SET(X,Y,C)
550 X=X+1
560 NEXT:RETURN
570 
580 ' Show 4 bits reversed
590 FOR BT=7 TO 4 STEP -1:IF Z AND BT(BT) THEN IF C=0 THEN RESET(X,Y) ELSE SET(X,Y,C)
600 X=X+1
610 NEXT:RETURN
620 
630 ' Color lookup table
640 'COLOR_BLACK=0
650 'COLOR_LTGRAY=1
660 'COLOR_WHITE=2
670 'COLOR_YELLOW=3
680 'COLOR_ORANGE=4
690 'COLOR_RED=5
700 'COLOR_PURPLE=6
710 'COLOR_BLUE=7
720 'COLOR_LTCYAN=8
730 'COLOR_CYAN=9
740 'COLOR_DKGREEN=10
750 'COLOR_LIMEGREEN=11
760 'COLOR_OLIVEGREEN=12
770 'COLOR_TAN=13
780 'COLOR_FLASH=14
790 DATA 0,5,5,2,8,4,3,3,6,6,1,1,1,2,0
800 ' Room graphics
810 '
820 ' 23 room designs used to make up 30 game rooms.
830 '
840 ' Left of Name Room
850 ' 0-roomGfxLeftOfName
860 DATA &HF0,&HFF,&HFF
870 DATA &H00,&H00,&H00
880 DATA &H00,&H00,&H00
890 DATA &H00,&H00,&H00
900 DATA &H00,&H00,&H00
910 DATA &H00,&H00,&H00
920 DATA &HF0,&HFF,&H0F
930 '
940 ' Below Yellow Castle
950 ' 1-roomGfxBelowYellowCastle
960 DATA &HF0,&HFF,&H0F
970 DATA &H00,&H00,&H00
980 DATA &H00,&H00,&H00
990 DATA &H00,&H00,&H00
1000 DATA &H00,&H00,&H00
1010 DATA &H00,&H00,&H00
1020 DATA &HF0,&HFF,&HFF
1030 '
1040 ' Side Corridor
1050 ' 2-roomGfxSideCorridor
1060 DATA &HF0,&HFF,&H0F
1070 DATA &H00,&H00,&H00
1080 DATA &H00,&H00,&H00
1090 DATA &H00,&H00,&H00
1100 DATA &H00,&H00,&H00
1110 DATA &H00,&H00,&H00
1120 DATA &HF0,&HFF,&H0F
1130 '
1140 ' Number Room Definition
1150 ' 3-roomGfxNumberRoom
1160 DATA &HF0,&HFF,&HFF
1170 DATA &H30,&H00,&H00
1180 DATA &H30,&H00,&H00
1190 DATA &H30,&H00,&H00
1200 DATA &H30,&H00,&H00
1210 DATA &H30,&H00,&H00
1220 DATA &HF0,&HFF,&H0F
1230 '
1240 ' ???
1250 ' 4-roomGfxTwoExitRoom
1260 DATA &HF0,&HFF,&H0F
1270 DATA &H30,&H00,&H00
1280 DATA &H30,&H00,&H00
1290 DATA &H30,&H00,&H00
1300 DATA &H30,&H00,&H00
1310 DATA &H30,&H00,&H00
1320 DATA &HF0,&HFF,&H0F
1330 '
1340 ' Top of Blue Maze
1350 ' 5-roomGfxBlueMazeTop
1360 DATA &HF0,&HFF,&H0F
1370 DATA &H00,&H0C,&H0C
1380 DATA &HF0,&H0C,&H3C
1390 DATA &HF0,&H0C,&H00
1400 DATA &HF0,&HFF,&H3F
1410 DATA &H00,&H30,&H30
1420 DATA &HF0,&H33,&H3F
1430 '
1440 ' Blue Maze #1
1450 ' 6-roomGfxBlueMaze1
1460 DATA &HF0,&HFF,&HFF
1470 DATA &H00,&H00,&H00
1480 DATA &HF0,&HFC,&HFF
1490 DATA &HF0,&H00,&HC0
1500 DATA &HF0,&H3F,&HCF
1510 DATA &H00,&H30,&HCC
1520 DATA &HF0,&HF3,&HCC
1530 '
1540 ' Bottom of Blue Maze
1550 ' 7-roomGfxBlueMazeBottom
1560 DATA &HF0,&HF3,&H0C
1570 DATA &H00,&H30,&H0C
1580 DATA &HF0,&H3F,&H0F
1590 DATA &HF0,&H00,&H00
1600 DATA &HF0,&HF0,&H00
1610 DATA &H00,&H30,&H00
1620 DATA &HF0,&HFF,&HFF
1630 '
1640 ' Center of Blue Maze
1650 ' 8-roomGfxBlueMazeCenter
1660 DATA &HF0,&H33,&H3F
1670 DATA &H00,&H30,&H3C
1680 DATA &HF0,&HFF,&H3C
1690 DATA &H00,&H03,&H3C
1700 DATA &HF0,&H33,&H3C
1710 DATA &H00,&H33,&H0C
1720 DATA &HF0,&HF3,&H0C
1730 '
1740 ' Blue Maze Entry
1750 ' 9-roomGfxBlueMazeEntry
1760 DATA &HF0,&HF3,&HCC
1770 DATA &H00,&H33,&H0C
1780 DATA &HF0,&H33,&HFC
1790 DATA &H00,&H33,&H00
1800 DATA &HF0,&HF3,&HFF
1810 DATA &H00,&H00,&H00
1820 DATA &HF0,&HFF,&H0F
1830 '
1840 ' Maze Middle
1850 ' 10-roomGfxMazeMiddle
1860 DATA &HF0,&HFF,&HCC
1870 DATA &H00,&H00,&HCC
1880 DATA &HF0,&H03,&HCF
1890 DATA &H00,&H03,&H00
1900 DATA &HF0,&HF3,&HFC
1910 DATA &H00,&H33,&H0C
1920 DATA &HF0,&H33,&HCC
1930 '
1940 ' Maze Side
1950 ' 11-roomGfxMazeSide
1960 DATA &HF0,&H33,&HCC
1970 DATA &H00,&H30,&HCC
1980 DATA &H00,&H3F,&HCF
1990 DATA &H00,&H00,&HC0
2000 DATA &H00,&H3F,&HC3
2010 DATA &H00,&H30,&HC0
2020 DATA &HF0,&HFF,&HFF
2030 '
2040 ' Maze Entry
2050 ' 12-roomGfxMazeEntry
2060 DATA &HF0,&HFF,&H0F
2070 DATA &H00,&H30,&H00
2080 DATA &HF0,&H30,&HFF
2090 DATA &H00,&H30,&HC0
2100 DATA &HF0,&HF3,&HC0
2110 DATA &H00,&H03,&HC0
2120 DATA &HF0,&HFF,&HCC
2130 '
2140 ' Castle
2150 ' 13-roomGfxCastle
2160 DATA &HF0,&HFE,&H15
2170 DATA &H30,&H03,&H1F
2180 DATA &H30,&H03,&HFF
2190 DATA &H30,&H00,&HFF
2200 DATA &H30,&H00,&H3F
2210 DATA &H30,&H00,&H00
2220 DATA &HF0,&HFF,&H0F
2230 '
2240 ' Red Maze #1
2250 ' 14-roomGfxRedMaze1
2260 DATA &HF0,&HFF,&HFF
2270 DATA &H00,&H00,&H00
2280 DATA &HF0,&HFF,&H0F
2290 DATA &H00,&H00,&H0C
2300 DATA &HF0,&HFF,&H0C
2310 DATA &HF0,&H03,&HCC
2320 DATA &HF0,&H33,&HCF
2330 '
2340 ' Bottom of Red Maze
2350 ' 15-roomGfxRedMazeBottom
2360 DATA &HF0,&H33,&HCF
2370 DATA &HF0,&H30,&H00
2380 DATA &HF0,&H33,&HFF
2390 DATA &H00,&H33,&H00
2400 DATA &HF0,&HFF,&H00
2410 DATA &H00,&H00,&H00
2420 DATA &HF0,&HFF,&H0F
2430 'Top of Red Maze
2440 ' 16-roomGfxRedMazeTop
2450 DATA &HF0,&HFF,&HFF
2460 DATA &H00,&H00,&HC0
2470 DATA &HF0,&HFF,&HCF
2480 DATA &H00,&H00,&HCC
2490 DATA &HF0,&H33,&HFF
2500 DATA &HF0,&H33,&H00
2510 DATA &HF0,&H3F,&H0C
2520 '
2530 ' White Castle Entry
2540 ' 17-roomGfxWhiteCastleEntry
2550 DATA &HF0,&H3F,&H0C
2560 DATA &HF0,&H00,&H0C
2570 DATA &HF0,&HFF,&H0F
2580 DATA &H00,&H30,&H00
2590 DATA &HF0,&H30,&H00
2600 DATA &H00,&H30,&H00
2610 DATA &HF0,&HFF,&H0F
2620 '
2630 ' Top Entry Room
2640 ' 18-roomGfxTopEntryRoom
2650 DATA &HF0,&HFF,&H0F
2660 DATA &H30,&H00,&H00
2670 DATA &H30,&H00,&H00
2680 DATA &H30,&H00,&H00
2690 DATA &H30,&H00,&H00
2700 DATA &H30,&H00,&H00
2710 DATA &HF0,&HFF,&HFF
2720 '
2730 ' Black Maze #1
2740 ' 19-roomGfxBlackMaze1
2750 DATA &HF0,&HF0,&HFF
2760 DATA &H00,&H00,&H03
2770 DATA &HF0,&HFF,&H03
2780 DATA &H00,&H00,&H00
2790 DATA &H30,&H3F,&HFF
2800 DATA &H00,&H30,&H00
2810 DATA &HF0,&HF0,&HFF
2820 '
2830 ' Black Maze #3
2840 ' 20-roomGfxBlackMaze3
2850 DATA &HF0,&HF0,&HFF
2860 DATA &H30,&H00,&H00
2870 DATA &H30,&H3F,&HFF
2880 DATA &H00,&H30,&H00
2890 DATA &HF0,&HF0,&HFF
2900 DATA &H30,&H00,&H03
2910 DATA &HF0,&HF0,&HFF
2920 '
2930 ' Black Maze #2
2940 ' 21-roomGfxBlackMaze2
2950 DATA &HF0,&HFF,&HFF
2960 DATA &H00,&H00,&HC0
2970 DATA &HF0,&HFF,&HCF
2980 DATA &H00,&H00,&H0C
2990 DATA &HF0,&H0F,&HFF
3000 DATA &H00,&H0F,&HC0
3010 DATA &H30,&HCF,&HCC
3020 '
3030 ' Black Maze Entry
3040 ' 22-roomGfxBlackMazeEntry
3050 DATA &H30,&HCF,&HCC
3060 DATA &H00,&HC0,&HCC
3070 DATA &HF0,&HFF,&H0F
3080 DATA &H00,&H00,&H00
3090 DATA &HF0,&HFF,&H0F
3100 DATA &H00,&H00,&H00
3110 DATA &HF0,&HFF,&H0F
3120 '
3130 ' Indexed array of all rooms and their properties
3140 '
3150 ' ROOMFLAG_NONE = 0x00
3160 ' ROOMFLAG_MIRROR= 0x01 // bit 0 - 1 if graphics are mirrored, 0 for reversed
3170 ' ROOMFLAG_LEFTTHINWALL = 0x02 // bit 1 - 1 for left thin wall
3180 ' ROOMFLAG_RIGHTTHINWALL= 0x04 // bit 2 - 1 for right thin wall
3190 '
3200 '   GFX,RMFLG,CLR,   UP,RIGHT, DOWN, LEFT
3210 ' 0 - Number Room
3220 DATA  3, &H00,  6, &H00, &H00, &H00, &H00
3230 ' 1 - Top Access
3240 DATA  1, &H02, 12, &H08, &H02, &H80, &H03
3250 ' 2 - Top Access
3260 DATA  1, &H00, 11, &H11, &H03, &H83, &H01
3270 ' 3 - Left of Name
3280 DATA  0, &H03, 13, &H06, &H01, &H86, &H02
3290 ' 4 - Top of Blue Maze
3300 DATA  5, &H00,  7, &H10, &H05, &H07, &H06
3310 ' 5 - Blue Maze #1
3320 DATA  6, &H00,  7, &H1D, &H06, &H08, &H04
3330 ' 6 - Bottom of Blue Maze
3340 DATA  7, &H00,  7, &H07, &H04, &H03, &H05
3350 ' 7 - Center of Blue Maze
3360 DATA  8, &H00,  7, &H04, &H08, &H06, &H08
3370 ' 8 - Blue Maze Entry
3380 DATA  9, &H00,  7, &H05, &H07, &H01, &H07
3390 ' 9 - Maze Middle
3400 DATA 10, &H00,  1, &H0A, &H0A, &H0B, &H0A
3410 ' A - Maze Entry
3420 DATA 12, &H00,  1, &H03, &H09, &H09, &H09
3430 ' B - Maze Side
3440 DATA 11, &H00,  1, &H09, &H0C, &H1C, &H0D
3450 ' C - Side Corridor
3460 DATA  2, &H03,  8, &H1C, &H0D, &H1D, &H0B
3470 ' D - Side Corridor
3480 DATA  2, &H02, 10, &H0F, &H0B, &H0E, &H0C
3490 ' E - Top Entry Room
3500 DATA 18, &H00,  9, &H0D, &H10, &H0F, &H10
3510 ' F - White Castle
3520 DATA 13, &H00,  2, &H0E, &H0F, &H0D, &H0F
3530 '10 - Black Castle
3540 DATA 13, &H00,  0, &H01, &H1C, &H04, &H1C
3550 '11 - Yellow Castle
3560 DATA 13, &H00,  3, &H06, &H03, &H02, &H01
3570 '12 - Yellow Castle Entry
3580 DATA  3, &H00,  3, &H12, &H12, &H12, &H12
3590 '13 - Black Maze #1
3600 DATA 19, &H00,  1, &H15, &H14, &H15, &H16
3610 '14 - Black Maze #2
3620 DATA 21, &H01,  1, &H16, &H15, &H16, &H13
3630 '15 - Black Maze #3
3640 DATA 20, &H01,  1, &H13, &H16, &H13, &H14
3650 '16 - Black Maze Entry
3660 DATA 22, &H00,  1, &H14, &H13, &H1B, &H15
3670 '17 - Red Maze #1
3680 DATA 14, &H00,  5, &H19, &H18, &H19, &H18
3690 '18 - Top of Red Maze
3700 DATA 16, &H00,  5, &H1A, &H17, &H1A, &H17
3710 '19 - Bottom of Red Maze
3720 DATA 15, &H00,  5, &H17, &H1A, &H17, &H1A
3730 '1A - White Castle Entry
3740 DATA 17, &H00,  5, &H18, &H19, &H18, &H19
3750 '1B - Black Castle Entry
3760 DATA  4, &H00,  5, &H89, &H89, &H89, &H89
3770 '1C - Other Purple Room
3780 DATA  3, &H00,  6, &H1D, &H07, &H8C, &H08
3790 '1D - Top Entry Room
3800 DATA 18, &H00,  5, &H8F, &H01, &H10, &H03
3810 '1E - Name Room
3820 DATA  1, &H00,  6, &H06, &H01, &H06, &H03
